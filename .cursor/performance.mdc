---
description: 실적 등록/관리 페이지를 개발하거나 CSV 업로드, 일괄 처리 기능을 구현할 때 참고
globs:
alwaysApply: false
---

## 라우트 (URL)
### 실적 관리
- `/` - 단일 실적 등록 (POST, 실무자 이상)
- `/bulk/` - 일괄 실적 등록 (POST, 실무자 이상)
- `/bulk-delete/` - 실적 일괄 삭제 (POST, 실무자 이상)
- `/csv-upload/` - CSV 파일 업로드 및 일괄 실적 등록 (POST, 실무자 이상)
- `/template/` - CSV 템플릿 다운로드 (GET)
- `/export/` - 월별 실적 데이터 CSV 다운로드 (GET, 인증 필요)
  - Query Parameters: `year` (연도), `month` (월)
  - Response: CSV 파일 (UTF-8 BOM 포함)
  - 404: 해당 연월에 데이터 없음
- `/list/` - 실적 목록 조회 (GET)
- `/<int:pk>/` - 실적 상세 조회 (GET)
- `/<int:pk>/update/` - 실적 수정 (PUT/PATCH, 실무자 이상)
- `/<int:pk>/delete/` - 실적 삭제 (DELETE, 실무자 이상, 물리삭제)

### 업체명 관리
- `/vendors/` - 업체명 목록 조회 (GET) / 생성 (POST, 실무자 이상)
- `/vendors/<int:pk>/` - 업체명 상세 조회 (GET) / 수정 (PUT/PATCH, 실무자 이상) / 삭제 (DELETE, 실무자 이상)

### 생산처 관리
- `/producers/` - 생산처 목록 조회 (GET) / 생성 (POST, 실무자 이상)
- `/producers/<int:pk>/` - 생산처 상세 조회 (GET) / 수정 (PUT/PATCH, 실무자 이상) / 삭제 (DELETE, 실무자 이상)

## 스키마 (모델)
**Vendor 모델**: 업체명 관리
- `id` (BigAutoField) - 기본키
- `name` (CharField, 100자, 고유) - 업체명
- `created_by` (ForeignKey to User) - 등록자
- `created_at`, `updated_at` - 타임스탬프

**Producer 모델**: 생산처 관리
- `id` (BigAutoField) - 기본키
- `name` (CharField, 100자, 고유) - 생산처명
- `created_by` (ForeignKey to User) - 등록자
- `created_at`, `updated_at` - 타임스탬프

**PerformanceRecord 모델**: 실적 기록 관리
- `record_uid` (CharField, 26자, 고유) - ULID 기반 비즈니스 식별자 (ulid.new() 사용)
- `type` (CharField) - 실적 유형 (inhouse:사내, incoming:수입)
- `date` (DateField) - 실적일
- `vendor` (CharField, 100자) - 업체명
- `product_name` (CharField, 100자) - 품명
- `control_no` (CharField, 100자) - 관리번호 (중복 허용)
- `quantity` (PositiveIntegerField) - 실적수량
- `producer` (CharField, 100자) - 생산처 (사내 실적: KOMEX 고정, 수입 실적: 선택)
- `weekday_code` (CharField, 3자, 자동계산) - 요일
- `created_by` (ForeignKey to User) - 작성자
- `created_at`, `updated_at` - 타임스탬프

## 서비스 함수
### 실적 관리
- `PerformanceCreateView` - 단일 실적 등록 (실무자 이상 권한 필요)
- `performance_bulk_create()` - 일괄 실적 등록 (전체 롤백/부분 저장 모드 지원)
- `performance_csv_upload()` - CSV 파일 업로드 및 일괄 등록 (5MB 제한, 1000행 제한)
- `performance_template_download()` - CSV 템플릿 다운로드 (UTF-8 BOM 포함)
- `performance_csv_export()` - 월별 실적 데이터 CSV 다운로드 (인증 필요)
  - 년도/월 기준으로 데이터 조회
  - CSV 헤더: 실적 ID, 유형, 실적일, 업체명, 품명, 관리번호, 수량, 생산처, 요일, 등록자, 등록일시
  - UTF-8 BOM 포함 (Excel 한글 호환)
  - 감사 로그 기록 (EXPORT_PERFORMANCE)
- `PerformanceListView` - 실적 목록 조회 (날짜 범위, 업체명 필터링 지원)
- `PerformanceDetailView` - 실적 상세 조회
- `PerformanceUpdateView` - 실적 수정 (실무자 이상 권한 필요)
- `PerformanceDeleteView` - 실적 물리 삭제 (실무자 이상 권한 필요)
- `performance_bulk_delete()` - 실적 일괄 삭제 (실무자 이상 권한 필요)

### 업체명/생산처 관리
- `VendorListCreateView` - 업체명 목록 조회 / 생성 (페이지네이션 없음, 실무자 이상 권한 필요)
- `VendorDetailView` - 업체명 상세 조회 / 수정 / 삭제 (실무자 이상 권한 필요)
- `ProducerListCreateView` - 생산처 목록 조회 / 생성 (페이지네이션 없음, 실무자 이상 권한 필요)
- `ProducerDetailView` - 생산처 상세 조회 / 수정 / 삭제 (실무자 이상 권한 필요)

### 유틸리티
- `format_validation_error()` - 검증 에러 상세 포맷팅 헬퍼 함수

## UI/UX 개선사항
### 실적 등록 폼
- 실적 유형: 토글 버튼 (사내/수입)
- 사내 실적: 생산처 자동 "KOMEX" 고정
- 수입 실적: 검색 가능한 콤보박스로 생산처 선택
- 업체명/생산처: 검색 가능한 콤보박스 + 관리 모달
- 관리 버튼: 📝 아이콘 + 파란색 배경으로 강조

### 탭 네비게이션
- 부적합 관리 페이지와 동일한 스타일
- 회색 배경 컨테이너 + 라운드 처리
- 선택된 탭: 흰색 배경 + 그림자 효과

### 피드백
- Toast(sonner) 알림으로 모든 성공/에러 메시지 표시
- 삭제 확인창 제거 (빠른 작업 흐름)

### 검색
- 실시간 검색 제거 (성능 개선)
- 검색 버튼 추가 + Enter 키 지원
